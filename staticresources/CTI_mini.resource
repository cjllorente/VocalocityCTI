function getDebugInstance(){function a(e){r.push(e);if(r.length>200){r=r.slice(100)}}function f(e){i.push(e);if(i.length>200){i=i.slice(100)}}function l(e,t){s.push({timestamp:Date.now(),name:e,scope:o,params:JSON.stringify(t,null,4)});o++}function c(e,t){s.push({timestamp:Date.now(),name:e,scope:o,retValue:JSON.stringify(t,null,4),isExit:true});o--}function h(){if(!t)t=new Date(r[0].timestamp);n=new Date(Date.now());var e=(n-t)/1e3;var i=0;var s="Displaying log info from "+t+" to "+n+".\n\n"+"User : "+CTI.user.getAgentName()+"\n"+"Extensions : "+CTI.user.getSelectedExtensions()+"\n\n";for(var o=0;o<r.length;o++){s+=r[o].timestamp+"--> Response Time: "+r[o].responseTime+"\n";i+=r[o].responseTime;for(var u=0;u<r[o].calls.length;u++){s+="     "+r[o].calls[u].direction+" call : "+r[o].calls[u].phone+"-->"+r[o].calls[u].status+"\n"}s+="\n"}s+="Total Running Time: "+e+"secs\n"+"Avg Response Time: "+(i/r.length).toFixed(3)+"secs\n\n";return s}function p(){var e="\n\nStack Trace:\n";for(var t=0;t<s.length;t++){for(var n=0;n<s[n].scope;n++){e+="----"}if(s[t].isExit){e+=s[t].timestamp+"-->Exiting : "+s[t].name+"\n    "+" returning : "+s[t].retValue+"\n"}else{e+=s[t].timestamp+"-->Entering : "+s[t].name+"\n    "+" with parameters : "+s[t].params+"\n"}e+="\n"}return e}function d(){var e=Cookie.read_map(CTI.cookies.user);e.password="*********";var t="\n\nApplication State-->\n\n"+"User Info:\n"+JSON.stringify(e,null,4)+"\n\nCall Info:\n"+JSON.stringify(Cookie.read_map(CTI.cookies.callInfo),null,4)+"\n\nLast Update:\n"+new Date(parseInt(Cookie.read(CTI.cookies.timestamp)))+"\n\nActive Monitors:"+Cookie.read(CTI.cookies.activeMonitors)+"\n\nLogged In: "+(Cookie.read(CTI.cookies.login)?true:false);return t}function v(){var e="\n\nErrors: \n";for(var t=0;t<i.length;t++){var n=i[t].message;if(typeof n==="object"){n=JSON.stringify(n,null,4)}e+="\n"+i[t].url+" Line "+i[t].line+" : "+i[t].message+"\n"}return e}function m(){var e=h()+v()+p()+d();var t=window.open("about:blank","_blank");t.document.write("<pre>"+e+"</pre>");g()}function g(){t=new Date(Date.now());n=null;r=[];var e=[];var i={};if(!u){u=true;window.onerror=function(e,t,n){CTI.debug.logError({message:e,line:n,url:t});return false}}}function y(e,t){return function(){l(e,arguments);var n=t(arguments[0],arguments[1],arguments[2]);c(e,n);return n}}if(!DEBUG){function e(){}return{init:e,log:e,logError:e,logFunction:e,display:e}}var t;var n;var r=[];var i=[];var s=[];var o=0;var u=false;return{init:g,log:a,logError:f,logFunction:y,display:m}}var DEBUG=false;var CTIController;var CTI=CTI||function(e){function t(){e(window).bind("beforeunload",CTI.close);CTI.ui.init();CTI.user.init();CTI.call.init();if(o()){CTI.ui.displayCTIPane();if(DEBUG){CTI.debug.init()}CTI.monitor.start()}else{CTI.ui.displayLoginPane()}}function n(){if(o()){CTI.monitor.stop();CTI.user.saveToCookie()}}function r(e){CTI[e]=CTI[e]||{}}function i(){return Cookie.read(CTI.cookies.activeMonitors)||0}function s(e){Cookie.write(CTI.cookies.activeMonitors,e)}function o(){return!!Cookie.read(CTI.cookies.login)}function u(){for(var e in CTI.cookies){Cookie.clear(CTI.cookies[e])}}return{debug:getDebugInstance(),init:t,close:n,namespace:r,getActiveMonitors:i,setActiveMonitors:s,isLoggedIn:o,clearCookies:u}}(jQuery);CTI.namespace("cookies");CTI.cookies={user:"cti_user",callInfo:"cti_call_info",login:"cti_login",activeMonitors:"cti_active_monitors",timestamp:"cti_timestamp",searchObjects:"apex__search_objects"};CTI.namespace("ui");CTI.ui=function(e){function c(){return l}function h(){t=e("#ctiPage");n=e("#loginPage");r=e("#failurePane");i=e("#username");s=e("#password");o=e("#agentNameField");u=e("#selectedExtensionsDiv");a=e("#loginForm");sforce.interaction.cti.enableClickToDial();sforce.interaction.cti.onClickToDial(S);sforce.interaction.cti.getSoftphoneLayout(function(t){var n=e.parseJSON(t.result);l.target=n.Inbound.screenPopSettings.screenPopsOpenWithin;l.noMatchSettings=n.Inbound.screenPopSettings.NoMatch;l.multipleMatchSettings=n.Inbound.screenPopSettings.MultipleMatches;l.singleMatchSettings=n.Inbound.screenPopSettings.SingleMatch;for(var r in n.Inbound.objects){l.objects.push(r)}Cookie.write(CTI.cookies.searchObjects,T(l.objects));if(l.noMatchSettings.screenPopType=="PopToEntity"){CTIController.getObjectPrefix(l.noMatchSettings.screenPopData,function(e,t){if(t.status){l.noMatchSettings.screenPopData=e+"/e"}else{CTI.debug.logError({message:e,line:53,url:"CTI_ui.resource"})}})}})}function p(){o.text(CTI.user.getAgentName());var r='<select id="selectedExtensions" class="s1" multiple="multiple" size="3" >';var i=CTI.user.getExtensions();var s=CTI.user.getSelectedExtensions();if(i.length==s.length){for(var a=0;a<i.length;a++){r+='<option value="'+i[a]+'" selected="selected">'+i[a]+"</option>"}}else{for(var a=0;a<i.length;a++){var f=false;for(var l=0;l<s.length;l++){if(i[a]==s[l]){f=true;break}}if(selected){r+='<option value="'+i[a]+'" selected="selected">'+i[a]+"</option>"}else{r+='<option value="'+i[a]+'">'+i[a]+"</option>"}}}r+="</select>";u.html(r);e("#dialpad a").bind("click",function(t){var n=e("#dialerField");var r=n.val();n.val(r+e(this).text())});n.hide();t.show();e('[id$="selectedExtensions"]').dropdownchecklist({width:100})}function y(e){if(e.clickToCall||e.callerNumber=="Restricted")return;CTIController.searchForScreenPop(e.formattedPhone,l.objects,function(t,n){if(!n.status){CTI.debug.logError({message:t,line:121,url:"CTI_ui.resource"});return}var r=e.callerName.split(" ");var i="?"+d+e.formattedPhone+v+r[0]+m+r[r.length-1];var s;if(t=="0"){switch(l.noMatchSettings.screenPopType){case"PopToEntity":s="/"+l.noMatchSettings.screenPopData+i;break;case"PopToVisualforce":s="/"+l.noMatchSettings.screenPopData+i;break;default:break}}else if(t=="multiple"){switch(l.multipleMatchSettings.screenPopType){case"PopToSearch":s="/_ui/search/ui/UnifiedSearchResults"+i+"&searchType=2";break;case"PopToVisualforce":s="/apex/"+l.multipleMatchSettings.screenPopData+i+"&objs="+T(l.objects);break;default:break}if(l.target=="NewWindow")CTI.user.saveToCookie()}else{switch(l.singleMatchSettings.screenPopType){case"PopToEntity":s="/"+t;break;case"PopToVisualforce":s="/"+l.singleMatchSettings.screenPopData+i;break;default:break}}if(s){sforce.interaction.screenPop(s)}})}function b(){t.hide();n.show();i.val("");s.val("")}function w(e,t){if(!e||!t){if(!a.valid()){return}e=i.val();t=s.val()}CTIController.login(e,t,function(e,t){if(t.status&&e!=null){Cookie.write_map(CTI.cookies.user,e);Cookie.write(CTI.cookies.login,1);CTI.user.init();p();CTI.monitor.start()}else{alert(f);CTI.debug.logError({message:t,line:203,url:"CTI_ui.resource"})}})}function E(){CTI.clearCookies();CTI.call.clearActiveCalls();CTI.monitor.stop();b()}function S(t){var n=e.parseJSON(t.result).objectId;var r=e.parseJSON(t.result).number.replace(/[\(\)+\-\s]/g,"");if(r.length==10){r="1"+r}x(r)}function x(e){if(!e)return;if(e=="DEBUG"){return CTI.debug&&CTI.debug.display()}CTIController.clickToCall(e,CTI.user.getInfo(),function(e,t){if(!t.status){CTI.debug.logError({message:e,line:246,url:"CTI_ui.resource"})}})}function T(e){var t="";var n=true;for(var r=0;r<e.length;r++){t+=(n?"":",")+e[r];n=false}return t}function N(){t.hide();n.hide();r.show()}var t,n,r,i,s,o,u,a;var f="Login failed. Ensure username/password are correct and that remote site settings are correctly configured.";var l={target:null,noMatchSettings:null,multipleMatchSettings:null,singleMatchSettings:null,objects:[],noMatchURL:null};var d="con10=";var v="&name_firstcon2=";var m="&name_lastcon2=";var g="00NG0000009Soc2";return{init:h,login:w,logout:E,getLayout:c,screenPop:y,clickToCall:x,displayCTIPane:p,displayLoginPane:b,displayApplicationFailure:N}}(jQuery);CTI.namespace("user");CTI.user=function(e){function p(){var e=Cookie.read_map(CTI.cookies.user);if(e){n=e.firstName;r=e.lastName;i=e.loginName;s=e.password;o=e.hdapToken;u=e.sessionId;a=e.softPhoneObjects;f=e.userId;l=e.extensions;c=e.selectedExtensions}}function d(){var e=y();Cookie.write_map(CTI.cookies.user,e)}function v(){return l}function m(){return c}function g(){return n+" "+r}function y(){return{firstName:n,lastName:r,loginName:i,password:s,hdapToken:o,sessionId:u,softPhoneObjects:CTI.ui.getLayout().objects,userId:f,extensions:l,selectedExtensions:c}}var t=false;var n,r,i,s,o,u,a,f,l,c,h;return{init:p,saveToCookie:d,getExtensions:v,getSelectedExtensions:m,getAgentName:g,getInfo:y}}(jQuery);CTI.namespace("call");CTI.call=function(e){function S(){E=e('[id$="callInfoList"]');CTIController.getNamespace(function(e){F="Id",I=e+"uid__c",q="Subject",R="CallDurationInSeconds",U="Status",z="Description",W="ActivityDate",X=e+"Agent__c",V=e+"Call_Tag__c",$=e+"Call_Type__c",J=e+"Call_Details__c",K=e+"Start_Time__c",Q=e+"End_Time__c",G=e+"Formatted_Duration__c"})}function T(e){return{agentName:e.agentName,callerName:e.callerName=="null"?"":e.callerName,callerNumber:e.callerNumber=="null"?"":e.callerNumber,customTag:e.customTag=="null"?"":e.customTag,startTime:parseInt(e.startTime)||Date.now(),callStatus:e.callStatus,callType:e.callType,extension:e.extension,recordingLink:e.recordingLink,clickToCall:e.clickToCall,comments:null,duration:0,formattedPhone:formatLocal("US",e.callerNumber),formattedDuration:"00:00:00",callLabel:x[e.callStatus]+(e.callerName=="null"?"":e.callerName),logId:null,objectId:null,objectName:"",displayed:e.callStatus==a,expanded:false,logCreated:false,userLogged:false,hangUpLogged:false,uidList:null,drawn:false,logStatus:v}}function N(e){ot();var n={};for(var r=0;r<e.length;r++){n[e[r].uid]=e[r]}var i={};var f=false;for(var l in n){if(n[l].callStatus==s){for(var l in t){if(t[l].callStatus==u||t[l].callStatus==o){t[l].callStatus=a}}continue}else if(n[l].callStatus==a&&!t[l]){continue}if(n[l].callStatus!=a){var c=n[l].callerNumber;var h=i[c];if(!h){i[c]=l;if(!t[l]){t[l]=T(n[l])}}else{if(!t[h].uidList){var p=new Object;p[h]=n[h].callStatus;t[h].uidList=p}t[l]=t[h];t[l].uidList=t[h].uidList}}if(t[l].uidList){t[l].uidList[l]="";for(var d in t[l].uidList){if(n[d]){t[l].uidList[d]=n[d].callStatus}}t[l].callStatus=C(t[l].uidList);t[l].callType=n[l].callType;t[l].callLabel=x[t[l].callStatus]+(t[l].callerName||"")}else{t[l].callStatus=n[l].callStatus;t[l].callType=n[l].callType;t[l].callLabel=x[t[l].callStatus]+(t[l].callerName||"")}}st()}function C(e){var t=a;for(var n in e){if(e[n]!=a){t=e[n]}if(t==u)return u}return t}function O(){var s="";var f=false;var l=ct();for(var c in t){t[c].drawn=false}var h=0;for(var p=0;p<l.length;p++){if(t[l[p]].callStatus==o||t[l[p]].callStatus==u){f=true}if(h>=i){delete t[l[p]]}else if(!t[l[p]].drawn){t[l[p]].drawn=true;s+=M(l[p]);h++}}if(!f){s='<li style="margin-bottom:3px;"><a href="#" class="head" >Listening for Call...</a></li>'+s;rt()}else{nt()}A=true;E.html(s);A=false;D();for(var c in t){var d=e("#bar_"+c);if(t[c].callStatus==o){e("#comments_"+c).hide();if(!t[c].displayed){d.css("background",y);d.effect("pulsate",{times:4},200)}else{d.css("background",b)}}else if(t[c].callStatus==u){if(!t[c].logCreated){Y(c)}if(!t[c].displayed){d.css("background",y)}else{d.css("background",b)}}else if(t[c].callStatus==a){if(!t[c].hangUpLogged){Z(c)}if(t[c].userLogged||t[c].logStatus==m){r=c;setTimeout(ft,n)}}if(!t[c].expanded){e("#call_info_"+c).hide()}H(c)}}function M(n){var r=t[n];var i=new Date(r.startTime);var s=i.toLocaleDateString();var o=i.toLocaleTimeString();return'<li><a href="#" class="head" id="bar_'+n+'" '+"onclick=\"CTI.call.callClicked('"+n+"');\">"+r.callLabel+"</a> "+'<div id="call_info_'+n+'">'+'<table id="info_table_'+n+'" cellpadding="0" cellspacing="0" class="caller-info">'+'<tr class="info_row">'+'<td class="info_label">Caller ID</td>'+'<td style="border:none;padding:0px">'+'<a href="#" >'+r.callerName+"</a>"+"</td>"+"</tr>"+'<tr class="info_row">'+'<td class="info_label">Number</td>'+"<td>"+'<a href="#">'+r.callerNumber+"</a>"+"</td>"+"</tr>"+'<tr class="info_row">'+'<td class="info_label">Call Tag</td>'+"<td> "+r.customTag+"</td>"+"</tr>    "+'<tr class="info_row">'+'<td class="info_label" >Date</td>'+"<td>"+s+"</td>"+"</tr>"+'<tr class="info_row">'+'<td class="info_label">Time</td>'+"<td>"+o+"</td>"+"</tr>"+'<tr class="info_row">'+'<td class="info_label">Duration</td>'+'<td id="duration_'+n+'">'+r.formattedDuration+"</td>"+"</tr>"+"</table> "+'<div id="comments_'+n+'" >'+'<h1 class="info_label">Comments</h1>'+(!k?'<textarea id="comments_field_'+n+'" '+'class="comments_field" '+'cols="25" rows="3"'+"onchange=\"CTI.call.saveComments('"+n+"')\" "+"onfocus=\"CTI.call.setFocusArea('comments_field_"+n+"', '"+n+"');\""+'onblur="CTI.call.clearFocus()">'+(e("#comments_field_"+n).val()||t[n].comments||"")+"</textarea><br/>":"")+'<button type="button" class="btnLogin" id="btnLogCall" style="float:right;"'+"onclick=\"CTI.call.logCall('"+n+"');\">"+"Log Call"+"</button>"+'<br class="float_clear"/>'+"</div>"+'<div id="message_'+n+'" ></div>'+"</div></li>"}function _(t,n){L=n;k=e("#"+t);return true}function D(){if(k){var t=e("div#comments_"+L);t.html('<h1 class="info_label">Comments</h1>');t.append(k);t.append('<button type="button" class="btnLogin" id="btnLogCall" style="float:right;"'+"onclick=\"CTI.call.logCall('"+L+"');\">"+"Log Call"+"</button>"+'<br class="float_clear"/>');k.focus()}}function P(){if(!A){L=null;k=null}}function H(n){var r=e("#message_"+n);var i=e("#info_table_"+n);var s=e("#comments_"+n);r.hide();switch(t[n].logStatus){case p:var o='<h1 class="log_success">       Success!</h1>'+'The <a href="/'+t[n].logId+'" target="_parent">Call Log</a> has been saved to '+'<a href="/'+t[n].objectId+'" target="_parent">'+t[n].objectName+"</a>";r.html(o);r.show();i.hide();s.hide();break;case d:var o='<h1 class="log_error">       Error!</h1>'+"<p>You must be on a record detail page to log a call.</p>";r.html(o);r.show();break;case m:var o="<h1>No Log Created!</h1>";r.html(o);r.show();i.hide();s.hide();break}}function B(n){if(!t[n])return;if((t[n].callStatus==o||t[n].callStatus==u)&&!t[n].expanded){for(call in t){e("#call_info_"+call).hide();t[call].expanded=false}e("#call_info_"+n).show("fast");t[n].expanded=true}else{e("#call_info_"+n).toggle("fast");t[n].expanded=!t[n].expanded}if(!t[n].displayed){e("#bar_"+n).css("background",b);t[n].displayed=true;st();CTI.ui.screenPop(t[n]);return}st()}function j(n){if(!t[n])return;t[n].comments=e("#comments_field_"+n).val();st()}function Y(e){if(!t[e])return;if(t[e].logId||!CTI.monitor.isMonitoring())return;var n=t[e];var r={};r[I]=e;r[q]="Call:Auto-Log";r[X]=n.agentName;r[V]=n.customTag||"";r[$]=n.clickToCall?h:c;r[W]=n.startTime;r[K]=(new Date(n.startTime)).toLocaleString();CTIController.saveLog(r,function(n){if(n.error){CTI.debug.logError({message:error,line:434,url:"CTI_call.resource"});return}t[e].logId=n.result;t[e].logStatus=g;st()})}function Z(e){if(!t[e])return;if(!CTI.monitor.isMonitoring())return;var n=t[e];if(n.logId==null){n.logStatus=m;st();return}var r=(new Date(n.startTime+n.duration*1e3)).toLocaleString();var i={};i[F]=n.logId;i[U]="Completed";i[R]=n.duration;i[G]=n.formattedDuration;i[Q]=r;CTIController.saveLog(i,function(n){if(n.error){CTI.debug.logError({message:error,line:469,url:"CTI_call.resource"});return}if(t[e]){t[e].hangUpLogged=true}st()})}function et(n){if(!t[n])return;var r=t[n];sforce.interaction.getPageInfo(function(i){var s=e.parseJSON(i.result);var o=s.objectId;var u=s.object;var a=s.objectName;if(!o||!lt(u)){t[n].logStatus=d;st();return}var f=u=="Contact"||u=="Lead"?"whoId":"whatId";var l={};l[F]=r.logId;l[f]=o;l[z]=e("#comments_field_"+n).val();l[J]=r.recordingLink;CTIController.saveLog(l,function(e){if(e.error){t[n].logStatus=d;CTI.debug.logError({message:error,line:509,url:"CTI_call.resource"})}else{t[n].logStatus=p;t[n].objectId=o;t[n].objectName=a;t[n].userLogged=true;st()}})})}function nt(){if(!tt){tt=setInterval(function(){it()},1e3)}}function rt(){if(tt){clearInterval(tt);tt=null}}function it(){for(var n in t){if(t[n].callStatus==a||t[n].callStatus==s)continue;CTIController.getCallDuration(t[n].startTime,function(r){if(!r)return;var i=(new XDate).clearTime().addSeconds(r).toString("HH:mm:ss");t[n].duration=r;t[n].formattedDuration=i;e("#duration_"+n).text(i)})}}function st(){Cookie.write_map(CTI.cookies.callInfo,t);Cookie.write(CTI.cookies.timestamp,Date.now())}function ot(){var e={};for(uid in t){if(t[uid].duration){e[uid+"_d"]=t[uid].duration;e[uid+"_f"]=t[uid].formattedDuration}}t=Cookie.read_map(CTI.cookies.callInfo)||{};for(uid in t){if(e[uid+"_d"]){t[uid].duration=e[uid+"_d"];t[uid].formattedDuration=e[uid+"_f"]}}}function ut(e){if(!t[e])return false;return t[e].callType==l}function at(){E.html("");t={}}function ft(){if(r){if(t[r].uidList){for(child in t[r].uidList){if(t[child])delete t[child]}}delete t[r];r=null;st()}}function lt(e){var t=Cookie.read(CTI.cookies.searchObjects).split(",");for(var n in t){if(e==t[n]){return true}}return false}function ct(){var e=[],n={},r=[];for(uid in t){if(t[uid].callType==l||t[uid].callStatus==s)continue;e.push(t[uid].startTime);n[t[uid].startTime]=uid}for(var i=1;i<e.length;i++){for(var o=i;o>0&&e[o]>e[o-1];o--){var u=e[o];e[o]=e[o-1];e[o-1]=u}}for(var i=0;i<e.length;i++){r.push(n[e[i]])}return r}function ht(){return t}var t={};var n=5e3;var r=null;var i=3;var s="Idle",o="Ringing",u="Connected",a="Disconnected",f="Conflict detected",s="Idle",l="intrapbx",c="inbound",h="outbound";var p="Success",d="Error",v="Not Created",m="No Log",g="Incomplete";var y="rgb(223, 63, 63)",b="rgb(72, 188, 55)",w="rgb(23, 151, 192)";var E;var x={Ringing:"Active Call: ",Connected:"Active Call: ",Disconnected:"Previous Call: "};var k,L,A;var F,I,q,R,U,z,W,X,V,$,J,K,Q,G;var tt;return{getActiveCallsList:ht,init:S,callClicked:B,clearActiveCalls:at,loadFromCookie:ot,updateFromPresence:N,displayCallInfo:O,saveComments:j,clearFocus:P,setFocusArea:_,logCall:et}}(jQuery);CTI.namespace("monitor");CTI.monitor=function(e){function m(){var e=Cookie.read(CTI.cookies.activeMonitors);if(e==null||e==0){if(!a){CTI.setActiveMonitors(1);a=setTimeout(x,50)}}else{if(!f){f=setInterval(y,s)}}if(!l){l=setInterval(b,o)}if(!c){c=setInterval(function(){return!CTI.isLoggedIn()&&CTI.ui.logout()},s)}}function g(){if(a){clearTimeout(a);a=null;CTI.setActiveMonitors(0);p=true}if(f){clearInterval(f);f=null}if(l){clearInterval(l);l=null}if(c){clearInterval(c);c=null}}function y(){var e=CTI.getActiveMonitors();if(e==0){g();m()}}function b(){var e=Cookie.read(CTI.cookies.timestamp);if(v<e){v=Date.now();CTI.call.loadFromCookie();CTI.call.displayCallInfo()}}function w(){return f!=null}function E(){return a!=null}function x(){S=null;if(!a||!CTI.isLoggedIn()){return}T();var e=new Date(Date.now());CTIController.monitor(CTI.user.getInfo(),p,function(s,o){if(!a||!CTI.isLoggedIn()){return}if(DEBUG){var u=new Date(Date.now());var f=(u-e).toFixed(3)/1e3;var l={calls:[],responseTime:f,timestamp:(new Date(Date.now())).toUTCString()};for(var c=0;c<s.length;c++){l.calls.push({status:s[c].callStatus||s[c].callType,phone:s[c].callerNumber||"",direction:s[c].callType||"no"})}CTI.debug.log(l)}if(!o.status){CTI.debug.logError({message:o,line:111,url:"CTI_monitor.resource"});return}else if(s!=null&&s[0].callType!=r){if(s[0].callType==t){p=true;CTI.ui.logout();return}if(s[0].callType!=n){CTI.call.updateFromPresence(s)}p=false}if(!h){S=S||setTimeout(x,10)}else{var v=i-(Date.now()-d);S=S||setTimeout(x,v>20?v:20)}k=0})}function T(){h=true;d=Date.now();setTimeout(N,i)}function N(){h=false;d=null}function L(){if(k<C){setTimeout(m,u);k++}else{g();CTI.ui.displayApplicationFailure()}}var t="Logged out",n="Conflict detected",r="Not modified";var i=3e3,s=1e3,o=1e3,u=3e4;var a,f,l,c,h=false,p=true;var d,v=0;var S;var C=1;var k=0;return{start:m,stop:g,isListening:w,isMonitoring:E}}(jQuery)